CREATE TABLE authors (id INTEGER PRIMARY KEY AUTOINCREMENT, fullname TEXT, booktitle TEXT, yearpub NUMERIC); 
    INSERT INTO authors (fullname, booktitle, yearpub) VALUES ("JK Rowling", "Harry Potter and the Philosopher's Stone", 1997);
    INSERT INTO authors (fullname, booktitle, yearpub) VALUES ("Michelle Zauner", "Crying in H Mart", 2021);
    INSERT INTO authors (fullname, booktitle, yearpub) VALUES ("Viola Davis", "Finding Me", 2022);
    INSERT INTO authors (fullname, booktitle, yearpub) VALUES ("Michelle Obama", "Becoming", 2018);
    INSERT INTO authors (fullname, booktitle, yearpub) VALUES ("Neil Gaiman", "Nevermore", 1996); 
    

CREATE TABLE birthinfo (author_id INTEGER PRIMARY KEY AUTOINCREMENT, city TEXT, country TEXT, year NUMERIC);
    INSERT INTO birthinfo (city, country, year) VALUES ("Yate", "UK", 1965);
    INSERT INTO birthinfo (city, country, year) VALUES ("Seoul", "Korea", 1989);
    INSERT INTO birthinfo (city, country, year) VALUES ("St Matthews", "US", 1965);
    INSERT INTO birthinfo (city, country, year) VALUES ("Chicago", "US", 1964);
    INSERT INTO birthinfo (city, country, year) VALUES ("Portchester", "UK", 1960); 
    
CREATE TABLE interview_pairs (id INTEGER PRIMARY KEY AUTOINCREMENT, author1_id INTEGER, author2_id INTEGER);
    INSERT INTO interview_pairs (author1_id, author2_id) VALUES (1,3);
    INSERT INTO interview_pairs (author1_id, author2_id) VALUES (2,4);
    INSERT INTO interview_pairs (author1_id, author2_id) VALUES (5,3);
    

-- Combine all the information into one coherent table

SELECT id AS "ID", fullname AS "Name", booktitle AS "Book Title", year AS "Birth Year", City, Country
    FROM authors
    JOIN birthinfo
    ON authors.id = birthinfo.author_id; 


-- Which authors are born outside the US?

SELECT fullname AS "name", country AS "birth country" FROM birthinfo 
    JOIN authors
        ON authors.id = birthinfo.author_id
    WHERE country NOT LIKE "US"; 

-- Which authors are paired together for an interview? 

SELECT a.fullname AS "Interviewer 1", b.fullname AS "Interviewer 2" 
    FROM interview_pairs
    JOIN authors a 
        ON author1_id = a.id
    JOIN authors b
        ON author2_id = b.id;
        
-- How old was each author when his/her book was published? 

SELECT fullname AS "Full Name", booktitle AS "Book Title", yearpub AS "Year Published", authors.yearpub-birthinfo.year AS "Author's Age"
FROM authors
JOIN birthinfo
    ON authors.id = birthinfo.author_id; 
    
